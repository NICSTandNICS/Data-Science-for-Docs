---
title: "Getting Data Into R"
author: "Dr Ahmed Al-Hindawi"
date: "13 April 2016"
output: ioslides_presentation
---

## Aims

Getting Data into R can be accomplished in many ways. I'll be demonstrating two that are practical

1. Using in-built functions to import CSV files
2. Using GoogleSheets

## Using in-built function

We can import Comma Separated Values (CSV) files into R very easily. These files can be generated by Microsoft Excel, Apple Numbers and Google Sheets usually through a File -> Export process.

Once a sheet has been exported, it can be imported into R:


```{r, eval=FALSE}
df <- read.csv(LOCATION_OF_FILE, header=TRUE)
```


This will create a variable called data in the global namespace with your sheet. Columns can then be referenced by:

```{r, eval=FALSE}
df$column_name
```

## Using Google Sheets

Using Google Sheets is a slightly more advanced way of getting data into R but it is more powerful. It allows the creation of seamless data analytics. Using Google Forms, one can input the data into a pre-validated form that then gets automatically inserted into a sheet that then gets pulled in automatically into R next time you run your script.

## Install Libraries

We will need to install the `googlesheets` library to import data from Google Sheets.

```{r, eval=FALSE}
install.packages("googlesheets")
```

Once the package has been installed, load it into your R script:

```{r, eval=FALSE}
library("googlesheets"")
```

## Accessing Sheet
Now list all the sheets available (local and ones shared to your account as shown https://docs.google.com/spreadsheets/) using

```{r, eval=FALSE}
gs_ls()
```

On the first run, it will ask you to authorise the package 'googlespreadsheet' to view your account by copying a link from the console and pasting it into a browser. Once you have authorised it, you will receive a code from your browser which you can then paste into the console. A list of all your sheets will then be printed in the console.

## Accessing Sheet
To access the sheet:

```{r, eval=FALSE}
    sheet <- gs_title(YOUR_TITLE)
```

Where YOUR_TITLE is the name of the sheet as shown in the gs_ls command. gs_title will authorise the use of that sheet.

To get access to the worksheet:

```{r, eval=FALSE}
    df <- gs_read(ss = sheet, ws = NAME_OF_WORKSHEET)
```

data variable now contains a dataframe much like importing from CSV. You can access columns by:

```{r, eval=FALSE}
    df$column_name
```

## Alternatively

You can get the "key" of the googlesheet from the URL (the long big).

```{r, eval=FALSE}
gap <- gs_key("1rAkCgL9qsUYw0wxRyb6R-JKpb8694Te0VqGlbM1Gh2w")

df <- gs_read_csv(ss=gap, ws = "Form responses 1")
```

The sheet needs to be "public" through File -> Publish To The Web

## Questions?

